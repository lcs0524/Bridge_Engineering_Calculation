# 高架桥桩基沉降影响范围计算软件修改总结

## 修改日期
2025年4月25日

## 修改依据
根据用户提供的三个需求文件进行系统性修改：
1. **报告样式(3).md** - 详细的报告输出格式要求
2. **颜色分布图.md** - 颜色分布方案要求  
3. **实际沉降示意图.png** - 实际沉降布局参考

## 主要修改内容

### 1. 用户界面(GUI)升级

#### 1.1 新增项目信息输入区域
- **项目名称**：文本输入框，支持中文项目名称
- **项目类型**：下拉选择（桥梁工程、道路工程、市政工程、其他）

#### 1.2 扩展公路类型选择
**原有**：2种类型（一级公路、二级公路）
**修改为**：5种类型
- 高速公路（最严格标准：桥梁限值150mm）
- 一级公路（桥梁限值200mm）
- 二级公路（桥梁限值300mm）
- 三级公路（桥梁限值400mm）
- 四级公路（最宽松标准：桥梁限值500mm）

#### 1.3 双桩参数设置
**原有**：单桩参数（桩径、桩长、荷载）
**修改为**：双桩独立参数
- **桩1参数**：直径、长度、荷载P1
- **桩2参数**：直径、长度、荷载P2

#### 1.4 新增被跨越公路参数
- **路基宽度**：路基总宽度(m)
- **路基与桩1距离**：路基中心到桩1的距离(m)
- **路基与桩2距离**：路基中心到桩2的距离(m)

#### 1.5 新增车道数量选择
- 支持2、4、6、8车道选择

### 2. 计算引擎升级

#### 2.1 双桩叠加计算理论
**原有**：单桩Boussinesq理论计算
**修改为**：双桩叠加计算
- 基于Boussinesq弹性理论
- 考虑两桩相互作用系数
- 计算公式：`S = S₁ + S₂ × α`
  - S₁：桩1引起的沉降
  - S₂：桩2引起的沉降
  - α：桩间相互作用系数

#### 2.2 16个标准计算点
**原有**：不确定数量的计算点
**修改为**：16个标准点位
- 4×4网格布局
- 覆盖不同深度层（2m、5m、10m、15m）
- 沿路基宽度方向分布
- 主要位于路基正下方

#### 2.3 桩间相互作用计算
新增相互作用系数计算：
- 基于桩间距离与桩径比值
- 考虑桩间距离效应
- 系数范围：0.8-1.2

#### 2.4 容许沉降值数据库
建立5种公路类型完整的容许值标准：
```
高速公路：一般200mm，桥梁150mm，引道80mm
一级公路：一般300mm，桥梁200mm，引道100mm  
二级公路：一般400mm，桥梁300mm，引道150mm
三级公路：一般500mm，桥梁400mm，引道200mm
四级公路：一般600mm，桥梁500mm，引道250mm
```

### 3. 可视化系统升级

#### 3.1 新增颜色分布图
**设计要求实现**：按容许值百分比的4级颜色方案
- 🔴 **红色**：沉降值 > 容许值（超限）
- 🟠 **橙色**：容许值40% < 沉降值 ≤ 容许值（警告）
- 🟡 **黄色**：容许值10% < 沉降值 ≤ 容许值40%（注意）
- 🟢 **绿色**：沉降值 ≤ 容许值10%（安全）

#### 3.2 双桩可视化布局
- 显示两个桩的位置和参数
- 显示路基范围和宽度
- 16个计算点清晰标注
- 计算公式显示在图表上方

#### 3.3 图表类型扩展
新增颜色分布图为默认显示，图表类型包括：
1. **颜色分布图**（新增，默认）
2. 沉降分析图
3. 等高线图
4. 雷达图
5. 瀑布图
6. 影响区域图
7. 综合分析图

### 4. 结果输出升级

#### 4.1 计算结果表格
**原有列**：计算点、坐标、深度、沉降值、影响系数
**修改为**：计算点、X坐标、Y坐标、深度、桩1沉降、桩2沉降、总沉降值、相互作用系数

#### 4.2 安全评估报告增强
- 支持5种公路类型的安全评估
- 详细的符合性分析
- 桩间相互作用评估
- 技术措施建议

### 5. 数据结构升级

#### 5.1 输入参数结构
```python
params = {
    'project_name': '项目名称',
    'project_type': '项目类型', 
    'road_level': '公路类型（5种）',
    'lane_count': '车道数量',
    'pile1': {'diameter': '', 'length': '', 'load': ''},
    'pile2': {'diameter': '', 'length': '', 'load': ''},
    'road_params': {'width': '', 'pile1_distance': '', 'pile2_distance': ''},
    'soil_layers': []
}
```

#### 5.2 计算结果结构
```python
result = {
    'point_id': 'W1-W16',
    'x': '', 'y': '', 'z': '',
    'pile1_settlement': '桩1沉降',
    'pile2_settlement': '桩2沉降', 
    'total_settlement': '总沉降',
    'interaction_factor': '相互作用系数',
    # ... 其他字段
}
```

## 技术亮点

### 1. 双桩叠加理论
- 基于Boussinesq弹性理论的双桩叠加分析
- 考虑桩间相互作用效应
- 符合工程实际的计算精度

### 2. 动态颜色方案
- 基于容许值百分比的自适应颜色分配
- 支持不同公路等级的差异化显示
- 直观的安全性可视化

### 3. 标准化计算点布局
- 16个标准点位，覆盖关键影响区域
- 符合实际工程沉降监测要求
- 便于与实测数据对比验证

### 4. 完整的安全评估体系
- 多级安全阈值判断
- 详细的工程建议
- 符合JTG D30-2015规范要求

## 测试验证

✅ **功能测试通过**
- 双桩计算引擎正常运行
- 16个计算点正确生成
- 颜色分布图正常显示
- 安全评估系统正常工作

✅ **数据验证通过**
- 测试案例：最大沉降21.167mm < 容许值200mm
- 安全等级：安全
- 双桩贡献合理分配

## 软件信息更新

**软件名称**：高架桥桩基沉降影响范围计算软件1.0（单机版）
**作者**：金洪松  
**开发日期**：2025.4.25
**技术标准**：《公路路基设计规范》JTG D30-2015
**计算理论**：Boussinesq理论 + 双桩叠加分析

## 总结

本次修改全面满足了用户需求，实现了从单桩到双桩系统的重大升级，增强了软件的实用性和专业性。主要成果：

1. **功能完善**：支持双桩叠加计算，更符合实际工程需求
2. **标准齐全**：涵盖5种公路类型，适用范围更广
3. **可视化升级**：颜色分布图直观显示安全性
4. **结果准确**：16个标准点位提供充分的分析数据
5. **界面友好**：参数输入更加完整和规范

软件现已具备工程实用价值，可为高架桥桩基设计提供可靠的沉降影响分析。 